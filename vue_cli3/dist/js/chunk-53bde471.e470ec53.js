(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53bde471"],{"0a4d":function(t,e,a){var o=a("abd8");e=o(!1),e.push([t.i,".gridtable[data-v-ca089b06]{border-collapse:collapse;width:100%}.gridtable thead>tr[data-v-ca089b06]{background:#dfe6ec;height:40px;line-height:40px}.gridtable td[data-v-ca089b06],.gridtable th[data-v-ca089b06]{border:1px solid #dfe6ec;font-size:14px;font-weight:400;text-align:center}.gridtable tbody>tr[data-v-ca089b06]:first-child{height:0}.gridtable .isClick[data-v-ca089b06]{color:#333;cursor:inherit}.gridtable tbody>tr[data-v-ca089b06]{height:40px;line-height:40px}.gridtable tbody>tr td[data-v-ca089b06]{padding:0 10px;max-width:500px}.gridtable tbody>tr td a[data-v-ca089b06]{color:#53abf3}.gridtable tbody>tr td span[data-v-ca089b06]{display:inline-block}.gridtable tbody>tr td span img[data-v-ca089b06]{width:150px;height:90px;margin:10px 0 10px 10px;cursor:pointer}",""]),t.exports=e},"0ee3":function(t,e,a){"use strict";var o=a("2eb1");a("7ae7"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("63ff");var i=o(a("57f0")),r=o(a("d88d")),n=o(a("6bf2")),s=a("b27f"),d={name:"Change-details",components:{CombinedForm:r.default},data:function(){var t=function(t,e,a){var o=/\s\S+|S+\s|\S/;if(!1===o.test(e))return a(new Error("请完善必填后提交"));a()};return{errMesInfo:[],changeRecord:{},tableData:null,mainInfoSource:{},feedBack:{},notPass:!1,unaudited:!0,dialogFormVisible:!1,auditId:"",projectName:"",projectModule:"",projectId:"",cityArr:{},passVal:"",isPass:!0,buttonIsShow:!0,isPassBtn:!1,ruleForm:{name:"",desc:""},rules:{desc:[{required:!0,message:"请完善必填后提交!",trigger:"blur"},{validator:t,trigger:"blur"}]},singlePriceIsError:!0,allPriceIsError:!0}},mounted:function(){this.getDetailInfo()},methods:{messageBox:function(){this.dialogFormVisible=!0,this.ruleForm.desc="",this.isPass=!0,this.passVal="不通过理由"},toInfoEditPage:function(){window.open("/index.php?r=yw-projects%2Fupdate&project_id=".concat(this.projectId,"&page_tag=view-common-info"))},submitNotPass:function(t){var e=this;console.log(t),this.$refs["ruleForm"].validate(function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(a){var o,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}return o={reason:e.ruleForm.desc,audit_id:e.auditId},t.next=4,e.axios.post("/backend-api/project-audit/refuse",o);case 4:i=t.sent,r=i.data,0===r.code?(e.dialogFormVisible=!1,e.buttonIsShow=!1,window.location.reload()):alert(r.msg),t.next=11;break;case 9:return console.log("error submit!!"),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},PassAudited:function(){this.dialogFormVisible=!0,this.isPass=!1,this.passVal="审核提示"},nextPass:function(t,e){var a=this;return(0,i.default)(regeneratorRuntime.mark((function o(){var i,r,n;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a.isPassBtn=!t,i={audit_id:a.auditId,check:e},o.next=4,a.axios.get("/backend-api/project-audit/pass",{params:i});case 4:r=o.sent,n=r.data,0===n.code?(a.dialogFormVisible=!1,a.buttonIsShow=!1,t?((0,s.setTimeout)((function(){window.location.reload()}),2e3),window.open(n.data.edit_url)):!1===t?window.location.reload():void 0===t&&!1===e&&(window.open(n.data.edit_url),window.location.reload())):1601===n.code?a.PassAudited():1007===n.code&&alert(n.msg);case 7:case"end":return o.stop()}}),o)})))()},giveupPass:function(){this.isPassBtn?this.nextPass(!1,!1):this.nextPass(void 0,!1)},goAuditorInfo:function(){var t=this.$router.resolve({path:"buildMessageAudit?id=".concat(this.projectId,"&projectName=").concat(this.projectName,"&projectModule=3")});window.open(t.href),this.dialogFormVisible=!1},getDetailInfo:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={id:t.$route.query.id},e.next=3,t.axios.get("/backend-api/project-audit/change-detail",{params:a});case 3:o=e.sent,i=o.data,i&&(t.cityArr=i.data,t.auditId=i.data.audit_id,t.tableData=i.data.change_content,t.changeRecord=i.data.change_record,t.mainInfoSource=i.data.main_info_source,t.feedBack=i.data.feedback,t.projectName=i.data.project_name,t.projectModule=i.data.change_content.module_id,t.projectId=i.data.project_id,t.errMesInfo=i.data.house_type_warn,"未审核"===t.feedBack.status_str?(t.unaudited=!1,t.buttonIsShow=!0):"审核驳回"===t.feedBack.status_str?(t.notPass=!0,t.buttonIsShow=!1):t.buttonIsShow=!1);case 6:case"end":return e.stop()}}),e)})))()},momentDate:function(t){return(0,n.default)(1e3*t).format("YYYY-MM-DD HH:mm:ss")},openBigPhoto:function(t){window.open(t)},hrefAuditor:function(){this.$router.push({path:"/building/buildMessageAudit"})}}};e.default=d},4731:function(t,e,a){var o=a("0a4d");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("85cb").default;i("88e2de08",o,!0,{sourceMap:!1,shadowMode:!1})},"6dde":function(t,e,a){"use strict";a.r(e);var o=a("0ee3"),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,(function(){return o[t]}))}(r);e["default"]=i.a},"6e65":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"el-card box-card table_container"},[a("div",{staticClass:"el-card__header"},[a("table",{staticClass:"gridtable",attrs:{border:""}},[t._m(0),a("tbody",[a("tr",[a("td",{attrs:{rowspan:t.rowspanLength(t.tableData.change_detail)}},[t._v(t._s(t.tableData.op_type))]),a("td",{attrs:{rowspan:t.rowspanLength(t.tableData.change_detail)}},[t._v(t._s(t.tableData.module))]),a("td",{attrs:{rowspan:t.rowspanLength(t.tableData.change_detail)}},[a("a",{attrs:{href:""===t.tableData.building_url?"javascript:void(0);":t.tableData.building_url,target:"_blank"}},[t._v(t._s(t.tableData.building_name))])]),a("td",{attrs:{rowspan:t.rowspanLength(t.tableData.change_detail)}},[a("a",{attrs:{href:""===t.tableData.house_type_url?"javascript:void(0);":t.tableData.house_type_url,target:"_blank"}},[t._v(t._s(t.tableData.house_type_name))])]),a("td",{directives:[{name:"show",rawName:"v-show",value:t.isTdShow,expression:"isTdShow"}]}),a("td",{directives:[{name:"show",rawName:"v-show",value:t.isTdShow,expression:"isTdShow"}]}),a("td",{directives:[{name:"show",rawName:"v-show",value:t.isTdShow,expression:"isTdShow"}]})]),t._l(t.tableData.change_detail,(function(e,o){return a("tr",{key:o},[a("td",[t._v(t._s(e.field_name))]),a("td",{staticClass:"a"},[1===e.data_type&&e.new_value?a("div",t._l(e.new_value,(function(e,o){return a("span",{key:o,on:{click:function(a){return t.openBigPhoto(e.show_path)}}},[a("img",{attrs:{src:e.show_path}})])})),0):2===e.data_type&&e.new_value?a("div",[a("span",t._l(e.new_value,(function(e,o){return a("a",{key:o,attrs:{href:e.show_path,download:e.name}},[t._v(t._s(e.name))])})),0)]):3===e.data_type?a("span",[t._v(t._s(e.new_value))]):t._e()]),a("td",{staticClass:"a"},[1===e.data_type&&e.old_value?a("div",t._l(e.old_value,(function(e,o){return a("span",{key:o,on:{click:function(a){return t.openBigPhoto(e)}}},[a("img",{attrs:{src:e.show_path}})])})),0):2===e.data_type&&e.old_value?a("div",[a("span",t._l(e.old_value,(function(e,o){return a("a",{key:o,attrs:{href:e.show_path,download:e.name}},[t._v(t._s(e.name))])})),0)]):3===e.data_type?a("span",[t._v(t._s(e.old_value))]):t._e()])])}))],2)])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("变更类型")]),a("th",[t._v("内容分类")]),a("th",[t._v("楼栋名称")]),a("th",[t._v("户型名称")]),a("th",[t._v("字段名称")]),a("th",[t._v("变更后内容")]),a("th",[t._v("变更前内容")])])])}];a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return i}))},"7ae7":function(t,e,a){"use strict";var o=a("91fe"),i=a("f30e"),r=a("a8c9"),n=a("d68d"),s=a("ee6f"),d=a("684e"),l=a("01d7"),c=a("3132"),u=a("b1a1"),f=a("57c4"),p=a("bf98"),h=f("isConcatSpreadable"),b=9007199254740991,v="Maximum allowed index exceeded",m=p>=51||!i((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),_=u("concat"),g=function(t){if(!n(t))return!1;var e=t[h];return void 0!==e?!!e:r(t)},w=!m||!_;o({target:"Array",proto:!0,forced:w},{concat:function(t){var e,a,o,i,r,n=s(this),u=c(n,0),f=0;for(e=-1,o=arguments.length;e<o;e++)if(r=-1===e?n:arguments[e],g(r)){if(i=d(r.length),f+i>b)throw TypeError(v);for(a=0;a<i;a++,f++)a in r&&l(u,f,r[a])}else{if(f>=b)throw TypeError(v);l(u,f++,r)}return u.length=f,u}})},a1ae:function(t,e,a){var o=a("abd8");e=o(!1),e.push([t.i,".parentDetail[data-v-4f6ba802]{padding:30px 0 50px 20px}.detailBg[data-v-4f6ba802],.parentDetail[data-v-4f6ba802]{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.detailBg[data-v-4f6ba802]{background:#fff;padding:20px 20px 20px 20px}.detailPath p[data-v-4f6ba802]{font-size:14px;margin-bottom:20px}.detailPath p span[data-v-4f6ba802]{font-weight:700}.detailPath p span[data-v-4f6ba802]:hover{color:#5d97ec;cursor:pointer}.detailCity h2[data-v-4f6ba802]{font-size:20px;font-weight:700;display:inline-block}.changeContent[data-v-4f6ba802]{width:100%}.changeContent h3[data-v-4f6ba802],.changeInfo h3[data-v-4f6ba802],.feedback h3[data-v-4f6ba802],.primaryInformation h3[data-v-4f6ba802]{width:120px;height:20px;border-bottom:1px solid #333;padding:10px 0;-webkit-box-sizing:content-box;box-sizing:content-box;margin-bottom:18px;font-size:18px;font-weight:700}.changeInfo p[data-v-4f6ba802]{font-size:15px}.changeContent[data-v-4f6ba802],.changeInfo p[data-v-4f6ba802],.primaryInformation[data-v-4f6ba802]{margin-bottom:26px}.primaryInformation p[data-v-4f6ba802]{font-size:14px;font-weight:560;margin-bottom:14px;width:400px;word-break:break-word}.primaryInformation .fileDownload[data-v-4f6ba802]{font-size:14px;font-weight:560;margin-bottom:14px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.primaryInformation p img[data-v-4f6ba802]{width:120px;height:60px;margin-right:10px;margin-bottom:10px;cursor:pointer}.primaryInformation .fileDownload a[data-v-4f6ba802]{margin:10px 10px 0 0}.feedback p[data-v-4f6ba802]{font-size:14px;margin-bottom:10px}.passButton[data-v-4f6ba802]{margin:26px 0 0 40%}.parentDetail[data-v-4f6ba802] .el-form-item__content{margin-left:0!important}.parentDetail[data-v-4f6ba802] .el-textarea__inner{min-height:120px!important}.parentDetail[data-v-4f6ba802] .el-dialog__body{overflow-y:hidden}.parentDetail[data-v-4f6ba802] .dialog-footer{text-align:right}.parentDetail[data-v-4f6ba802] .el-dialog__header{text-align:center}.textVal[data-v-4f6ba802]{width:470px;word-wrap:break-word}.textFooter[data-v-4f6ba802]{margin-top:20px;text-align:center!important}.textFooter[data-v-4f6ba802] .el-button{display:inline-block;line-height:1;white-space:nowrap;cursor:pointer;background:#fff;border:1px solid #dcdfe6;color:#606266;-webkit-appearance:none;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;outline:0;margin:0;-webkit-transition:.1s;transition:.1s;font-weight:500;padding:12px 20px;font-size:14px;border-radius:4px;width:auto}.textFooter[data-v-4f6ba802] .el-button--primary{color:#fff;background-color:#409eff;border-color:#409eff;margin-left:10px}.fileHover[data-v-4f6ba802]:hover{color:#639cf1}.parentDetail[data-v-4f6ba802] .el-form-item__content{overflow:inherit}.isError[data-v-4f6ba802]{color:#fd0a0a}",""]),t.exports=e},ad99:function(t,e,a){"use strict";var o=a("fec5"),i=a.n(o);i.a},b27f:function(t,e,a){t.exports=a("8018")(103)},ca4d:function(t,e,a){"use strict";a.r(e);var o=a("fb8b"),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,(function(){return o[t]}))}(r);e["default"]=i.a},d88d:function(t,e,a){"use strict";a.r(e);var o=a("6e65"),i=a("ca4d");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("ec5b");var n=a("5511"),s=Object(n["a"])(i["default"],o["a"],o["b"],!1,null,"ca089b06",null);e["default"]=s.exports},d90c:function(t,e,a){"use strict";a.r(e);var o=a("deb3"),i=a("6dde");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("ad99");var n=a("5511"),s=Object(n["a"])(i["default"],o["a"],o["b"],!1,null,"4f6ba802",null);e["default"]=s.exports},deb3:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"parentDetail"},[a("div",{staticClass:"detailPath"},[a("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[t._v("首页")])]),a("el-breadcrumb-item",[a("a",{on:{click:t.hrefAuditor}},[t._v("楼盘动销信息审核")])]),a("el-breadcrumb-item",[t._v("变更详情")])],1)],1),a("div",{staticClass:"detailBg"},[a("div",{staticClass:"detailCity"},[a("h2",[t._v(t._s(t.cityArr.city_name))]),a("h2",[t._v(t._s(t.cityArr.project_name))])]),a("div",{staticClass:"changeInfo"},[a("h3",[t._v("变更基本信息")]),a("p",[t._v("变更记录: "+t._s(t.changeRecord.creator)+" "+t._s(t.momentDate(t.changeRecord.create_datetime)))])]),a("div",{staticClass:"changeContent"},[a("h3",[t._v("变更内容")]),t.tableData?a("Combined-form",{attrs:{tableData:t.tableData,changeRecord:t.changeRecord}}):t._e()],1),a("div",{staticClass:"feedback"},[a("h3",[t._v("系统报错信息")]),t.errMesInfo.length>0?a("p",[t._v("以下信息可能存在误差，请核对信息！ "),a("el-button",{attrs:{type:"text"},on:{click:t.toInfoEditPage}},[t._v("前往修改")])],1):t._e(),t._l(t.errMesInfo,(function(e){return a("p",{key:e.house_type_id},[a("span",[t._v("户型: "+t._s(e.house_type_text))]),a("span",{class:{isError:1==e.status_text.is_wrong}},[t._v("销售状态："+t._s(e.status_text.value))]),a("span",{class:{isError:1==e.price.is_wrong}},[t._v("单价："+t._s(e.price.value))]),a("span",{class:{isError:1==e.total_price.is_wrong}},[t._v("总价："+t._s(e.total_price.value))])])})),a("p",{directives:[{name:"show",rawName:"v-show",value:t.notPass,expression:"notPass"}]},[t._v("不通过理由: "+t._s(t.feedBack.remark)+" ")])],2),a("div",{staticClass:"primaryInformation"},[a("h3",[t._v("主要信息来源")]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!==this.mainInfoSource.info_source,expression:"this.mainInfoSource.info_source !== ''"}],staticClass:"origin"},[t._v("来源: "+t._s(this.mainInfoSource.info_source))]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!==this.mainInfoSource.info_name,expression:"this.mainInfoSource.info_name !== ''"}]},[t._v("其他网站名称: "+t._s(this.mainInfoSource.info_name))]),a("p",{directives:[{name:"show",rawName:"v-show",value:!!this.mainInfoSource.img_list&&0!==this.mainInfoSource.img_list.length,expression:"this.mainInfoSource.img_list ? this.mainInfoSource.img_list.length !== 0 : false"}]},t._l(t.mainInfoSource.img_list,(function(e,o){return a("img",{key:o,attrs:{src:e.show_path},on:{click:function(a){return t.openBigPhoto(e.show_path)}}})})),0),a("span",{directives:[{name:"show",rawName:"v-show",value:!!this.mainInfoSource.file_list&&0!==this.mainInfoSource.file_list.length,expression:"this.mainInfoSource.file_list ? this.mainInfoSource.file_list.length !== 0 : false"}],staticClass:"fileDownload"},t._l(this.mainInfoSource.file_list,(function(e,o){return a("p",{key:o},[a("a",{staticClass:"fileHover",attrs:{href:e.show_path,download:e.name}},[t._v(t._s(e.name))])])})),0)]),a("div",{staticClass:"feedback"},[a("h3",[t._v("反馈结果")]),a("p",[t._v("审核人: "+t._s(t.feedBack.auditor))]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.unaudited,expression:"unaudited"}]},[t._v("操作记录: "+t._s(t.feedBack.operator)+" "+t._s(t.momentDate(t.feedBack.time))+" "+t._s(t.feedBack.status_str))]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.notPass,expression:"notPass"}]},[t._v("不通过理由: "+t._s(t.feedBack.remark)+" ")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.buttonIsShow,expression:"buttonIsShow"}],staticClass:"passButton"},[a("el-button",{attrs:{type:"danger"},on:{click:t.messageBox}},[t._v("不通过")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.nextPass(!1)}}},[t._v("通过")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.nextPass(!0)}}},[t._v("通过并编辑信息")])],1)]),a("el-dialog",{attrs:{title:t.passVal,visible:t.dialogFormVisible,width:"500px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[t.isPass?a("div",[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"desc"}},[a("el-input",{attrs:{type:"textarea",maxlength:"300"},model:{value:t.ruleForm.desc,callback:function(e){t.$set(t.ruleForm,"desc",e)},expression:"ruleForm.desc"}})],1)],1),a("div",{staticClass:"dialog-footer textFooter",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitNotPass("ruleForm")}}},[t._v("确 定")])],1)],1):a("div",[a("p",{staticClass:"textVal"},[t._v("该次放量计划中存在未审核通过的楼栋信息，请先去审核相关的楼栋信息，再审核放量计划，否则本次放量计划关联的放量楼栋将无法被关联到居理的放量计划中！")]),a("div",{staticClass:"dialog-footer textFooter",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.goAuditorInfo}},[t._v("去审核楼栋信息")]),a("el-button",{attrs:{type:"primary"},on:{click:t.giveupPass}},[t._v("放弃楼栋继续通过")])],1)])])],1)},i=[];a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return i}))},ec5b:function(t,e,a){"use strict";var o=a("4731"),i=a.n(o);i.a},fb8b:function(t,e,a){"use strict";a("4045"),a("b3f9"),a("3e5e"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={props:["tableData"],data:function(){return{isClick:!1}},methods:{openBigPhoto:function(t){window.open(t)},rowspanLength:function(t){return t.length+1},isTdShow:function(){return"居理暂无该楼栋"===tableData.building_name},splitChangeContent:function(t){var e="";return t&&(e=void 0!==t&&"-"===t.substr(t.length-2,1)?t.substr(0,t.length-2):0==parseFloat(t)?"":void 0!==t&&-1!==t.indexOf("(0套)")?t.substr(0,t.indexOf("(0套)")):void 0!==t&&-1!==t.indexOf(".00")?t.split(".")[0]+t.split(".")[1].split(" ")[1]:t),e}},mounted:function(){"居理暂无该楼栋"===this.tableData.building_name?this.isClick=!0:this.isClick=!1}};e.default=o},fec5:function(t,e,a){var o=a("a1ae");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("85cb").default;i("3f51ef8d",o,!0,{sourceMap:!1,shadowMode:!1})}}]);